"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const __1 = require("..");
const pending_data_ports_1 = require("../models/internal/pending-data-ports");
async function invoke(_, message) {
    if (message.djs.attachments.size === 0)
        return "Veuillez réexécuter la commande avec votre fichier de données JSON joint.";
    const pendingList = new pending_data_ports_1.default();
    await pendingList.loadDocument();
    const guildId = message.guild.id;
    const memberId = message.member.id;
    if (pendingList.allPending.find(x => x.guildId === guildId))
        return "Vous avez déjà une importation ou une exportation en attente pour ce serveur, veuillez patienter avant de réessayer.";
    pendingList.allPending.push({
        guildId,
        memberId,
        channelId: message.channelId,
        isImport: true,
        url: message.djs.attachments.first().url,
    });
    await pendingList.save();
    return "Votre importation sera traitée en arrière-plan dans quelques minutes et vous recevrez un message de confirmation sur cette chaîne.";
}
exports.default = new __1.Command(
/*syntax*/ "import", 
/*description*/ "Importer des données pour cette guilde depuis JSON",
/*permissionLevel*/ __1.PermissionLevel.Admin, 
/*invoke*/ invoke);
//# sourceMappingURL=import-guild.js.map