"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const __1 = require("..");
const command_1 = require("../commands/command");
const event_strings_1 = require("../utilities/logging/event-strings");
const question_1 = require("../utilities/question");
async function invoke(_, message, client) {
    return new Promise(async (__, reject) => {
        const response = await new question_1.default(client, message.channelId, "\n" +
            "Voulez-vous vraiment supprimer toutes les données de ce serveur? (oui/non)", message.member, true).send();
        if (response.content.toLowerCase() === "oui") {
            await message.guild.deleteRecord();
            __1.Logger.logEvent(event_strings_1.EventStrings.GuildReset, { guildId: message.guild.id });
            /* This is a very hacky way of doing this, but when using resolve
               the Guild object gets saved back to the database straight away,
               meaning it'd be deleted and instnantly re-created. Using reject
               means that save doesn't get called by the parent. Very hacky but works. */
            reject(new __1.CommandRejection("Les données de ce serveur ont bien été supprimées"));
        }
        else
            reject(new __1.CommandRejection("Les données n'ont pas été supprimées"));
    });
}
exports.default = new command_1.default(
/*syntax*/ "reset", 
/*description*/ "Réinitialisez toutes les données de ce serveur Discord. ATTENTION: VOUS PERDREZ TOUS VOS PARAMÈTRES!",
/*permissionLevel*/ command_1.PermissionLevel.Admin, 
/*invoke*/ invoke);
//# sourceMappingURL=reset.js.map